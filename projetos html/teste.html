<html>
<head>
    <title>Export Html to Word Document with Styled Tables</title>
</head>
<body>

    <div class="certificate-container" id="exportContent">
        <!-- Conteúdo pré-definido para demonstração -->
        <table class="certificate-table">
            <tr><th id="title" colspan="5" style="background-color: #4CAF50; color: white;">BIRTH CERTIFICATE</th></tr>
            <tr><td id="name" colspan="5" style="background-color: #f2f2f2;">John Doe</td></tr>
            <tr><td id="ssn" colspan="5" style="background-color: #f9f9f9;">123-45-6789</td></tr>
            <tr><td id="registration" colspan="5" style="background-color: #f9f9f9;">AB-123456</td></tr>
            <tr>
                <td id="dob">01/01/1990</td>
                <td id="birth_city_state">New York, NY</td>
                <td id="registration_city_state">Albany, NY</td>
                <td id="hospital">Saint Hospital</td>
                <td id="gender">Male</td>
            </tr>
            <!-- Mais linhas aqui se necessário -->
        </table>
    </div>

    <button onclick="Export2Doc('exportContent', 'birth_certificate');">Export as Doc</button>

    <script>
    function Export2Doc(element, filename = ''){
        var preHtml = "<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>Export HTML To Word</title><style>table { width: 100%; border-collapse: collapse; } th, td { border: 1px solid black; padding: 8px; } th { background-color: #4CAF50; color: white; } .certificate-table td { background-color: #f9f9f9; } </style></head><body>";
        var postHtml = "</body></html>";
        var html = preHtml + document.getElementById(element).innerHTML + postHtml;

        var blob = new Blob(['\ufeff', html], {
            type: 'application/msword'
        });

        var url = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(html);

        filename = filename ? filename + '.doc' : 'document.doc';

        var downloadLink = document.createElement("a");
        document.body.appendChild(downloadLink);

        if (navigator.msSaveOrOpenBlob) {
            navigator.msSaveOrOpenBlob(blob, filename);
        } else {
            downloadLink.href = url;
            downloadLink.download = filename;
            downloadLink.click();
        }

        document.body.removeChild(downloadLink);
    }
    </script>
</body>
</html>
